(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{640:function(e,t,o){"use strict";o.r(t);var n=o(25),r=(o(64),o(1),o(15),o(586)),l=(o(587),o(588),{components:{DatePicker:r.default},props:{title:{type:String,default:"Solicitar Nº de Hoja de Trámite"}},data:function(){return{modalId:"modal-solicitar-hoja-tramite",openModalEvent:"open-solicitar-hoja-tramite-modal",refreshTableEvent:"refresh-table",msgSuccess:"Solicitud enviada exitosamente!!!",isProcessing:!1,item:{numero_operacion:"",nombre_banco:"",agencia:"",fecha_operacion:"",monto:"",distrito_id:"",recibo_pago:"",archivo_solicitud_ht:""},id_expediente:null,listDepartamento:[],listProvincia:[],listDistrito:[],provinciasFiltrado:[],distritosFiltrado:[],departamentoSelected:null,provinciaSelected:null,distritoSelected:null}},watch:{distritoSelected:function(e){this.item.distrito_id=e&&e.id?e.id:null}},mounted:function(){this.loadSelectOptions()},created:function(){var e=this;this.$nuxt.$on(this.openModalEvent,(function(t){e.id_expediente=t.id,e.showModal()}))},beforeDestroy:function(){this.$nuxt.$off(this.openModalEvent)},methods:{onChangeDepartamento:function(e){this.distritoSelected=null,this.provinciaSelected=null,this.distritosFiltrado=[],this.provinciasFiltrado=[],e&&(this.provinciasFiltrado=this.listProvincia.filter((function(i){return i.departamento_id==e.id})))},onChangeProvincia:function(e){e&&(this.distritoSelected=null,this.distritosFiltrado=this.listDistrito.filter((function(i){return i.provincia_id==e.id})))},refreshTable:function(){this.$nuxt.$emit(this.refreshTableEvent)},showModal:function(){this.$bvModal.show(this.modalId)},hideModal:function(){this.$bvModal.hide(this.modalId)},resetModal:function(){this.resetFormValues()},resetFormValues:function(){this.item.numero_operacion="",this.item.nombre_banco="",this.item.agencia="",this.item.fecha_operacion="",this.item.monto="",this.item.distrito_id="",this.item.recibo_pago="",this.item.archivo_solicitud_ht="",this.distritoSelected=null,this.provinciaSelected=null,this.departamentoSelected=null,this.distritosFiltrado=[],this.provinciasFiltrado=[],this.isProcessing=!1},handleOk:function(e){e.preventDefault(),this.onSubmit()},onSubmit:function(){var e=this;this.$refs.form.validate().then((function(t){if(t){e.isProcessing=!0;var data=new FormData;for(var o in data.append("_method","put"),e.item)data.append(o,e.item[o]);var n="/expedienteadhoc/"+e.id_expediente+"/solicitar_hoja_tramite";e.$axios.post(n,data).then((function(t){e.$notify({type:"success",text:e.msgSuccess})})).finally((function(){e.refreshTable(),e.hideModal()}))}}))},handleReciboFileChange:function(e){var t=e.target.files||e.dataTransfer.files;t.length&&(this.item.recibo_pago=t[0])},handleAnexoFileChange:function(e){var t=e.target.files||e.dataTransfer.files;t.length&&(this.item.archivo_solicitud_ht=t[0])},loadSelectOptions:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.get("/listasParaRegistro").then((function(t){e.listDepartamento=t.data.departamentos||[],e.listProvincia=t.data.provincias||[],e.listDistrito=t.data.distritos||[]}));case 2:case"end":return t.stop()}}),t)})))()}}}),c=o(12),component=Object(c.a)(l,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("b-modal",{attrs:{id:e.modalId,title:e.title,size:"lg"},on:{ok:e.handleOk,hidden:e.resetModal},scopedSlots:e._u([{key:"modal-footer",fn:function(t){var n=t.ok,r=t.cancel;return[o("b-button",{attrs:{size:"md",variant:"link"},on:{click:function(e){return r()}}},[e._v(" Cancelar")]),e._v(" "),o("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{type:"submit",size:"md",variant:"primary",title:e.title,disabled:e.isProcessing},on:{click:function(e){return n()}}},[o("span",{directives:[{name:"show",rawName:"v-show",value:e.isProcessing,expression:"isProcessing"}],staticClass:"spinner-border spinner-border-sm"}),e._v(" "),o("i",{directives:[{name:"show",rawName:"v-show",value:!e.isProcessing,expression:"!isProcessing"}],staticClass:"fas fa-paper-plane"}),e._v(" Solicitar\n      ")])]}}])},[o("ValidationObserver",{ref:"form",on:{submit:function(e){e.preventDefault()}},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.handleSubmit;return[o("b-form",{on:{submit:function(t){return t.preventDefault(),n(e.onSubmit)}}},[o("b-form-group",{staticClass:"mb-3",attrs:{label:"Mi correo electrónico personal:"}},[o("b-form-input",{attrs:{type:"text",readonly:"",value:e.$auth.user?e.$auth.user.email:""}}),e._v(" "),o("div",{staticClass:"form-text"},[e._v("Mesa de partes le responderá a este email.")])],1),e._v(" "),o("ValidationProvider",{attrs:{mode:"eager",rules:"required|ext:pdf|size:3072",name:"Anexo"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.validate,r=t.errors;return[o("b-form-group",{staticClass:"mb-3",attrs:{label:"Adjuntar Anexo Nº 5.PDF:"}},[o("input",{staticClass:"form-control",attrs:{type:"file"},on:{change:function(t){e.handleAnexoFileChange(t)||n(t)}}}),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:r.length,expression:"errors.length"}],staticClass:"invalid-feedback",staticStyle:{display:"block"}},[e._v("\n              "+e._s(r[0])+"\n            ")])])]}}],null,!0)}),e._v(" "),o("ValidationProvider",{attrs:{mode:"eager",rules:"required|ext:pdf|size:3072",name:"Recibo"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.validate,r=t.errors;return[o("b-form-group",{staticClass:"mb-3",attrs:{label:"Adjuntar Recibo de Pago.PDF:"}},[o("input",{staticClass:"form-control",attrs:{type:"file"},on:{change:function(t){e.handleReciboFileChange(t)||n(t)}}}),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:r.length,expression:"errors.length"}],staticClass:"invalid-feedback",staticStyle:{display:"block"}},[e._v("\n              "+e._s(r[0])+"\n            ")])])]}}],null,!0)}),e._v(" "),o("div",{staticClass:"row"},[o("div",{staticClass:"col-6"},[o("ValidationProvider",{attrs:{rules:"required|alpha_num_spaces",name:"Banco"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.validated,r=t.valid,l=t.errors;return[o("b-form-group",{staticClass:"mb-3",attrs:{label:"Nombre del Banco:"}},[o("b-form-input",{attrs:{type:"text",state:!(!n||!r)||!l[0]&&null},model:{value:e.item.nombre_banco,callback:function(t){e.$set(e.item,"nombre_banco",t)},expression:"item.nombre_banco"}}),e._v(" "),o("b-form-invalid-feedback",[e._v(e._s(l[0]))])],1)]}}],null,!0)})],1),e._v(" "),o("div",{staticClass:"col-6"},[o("ValidationProvider",{attrs:{rules:"required|alpha_num_spaces",name:"Agencia"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.validated,r=t.valid,l=t.errors;return[o("b-form-group",{staticClass:"mb-3",attrs:{label:"Nombre de la Agencia:"}},[o("b-form-input",{attrs:{type:"text",state:!(!n||!r)||!l[0]&&null},model:{value:e.item.agencia,callback:function(t){e.$set(e.item,"agencia",t)},expression:"item.agencia"}}),e._v(" "),o("b-form-invalid-feedback",[e._v(e._s(l[0]))])],1)]}}],null,!0)})],1)]),e._v(" "),o("div",{staticClass:"row"},[o("div",{staticClass:"col-6"},[o("ValidationProvider",{attrs:{rules:"required|alpha_num_spaces",name:"Nro Operación"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.validated,r=t.valid,l=t.errors;return[o("b-form-group",{staticClass:"mb-3",attrs:{label:"Número de Operación:"}},[o("b-form-input",{attrs:{type:"text",state:!(!n||!r)||!l[0]&&null},model:{value:e.item.numero_operacion,callback:function(t){e.$set(e.item,"numero_operacion",t)},expression:"item.numero_operacion"}}),e._v(" "),o("b-form-invalid-feedback",[e._v(e._s(l[0]))])],1)]}}],null,!0)})],1),e._v(" "),o("div",{staticClass:"col-6"},[o("ValidationProvider",{attrs:{rules:"required",name:"Fecha Operación"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.validated,r=t.valid,l=t.errors;return[o("b-form-group",{staticClass:"mb-3",attrs:{label:"Fecha de Operación:"}},[o("date-picker",{class:n&&r?"is-valid":l[0]?"is-invalid":"",attrs:{"first-day-of-week":1,lang:"es",format:"YYYY-MM-DD",valueType:"format","disabled-date":function(t){return t>=e.$moment()}},model:{value:e.item.fecha_operacion,callback:function(t){e.$set(e.item,"fecha_operacion",t)},expression:"item.fecha_operacion"}}),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:l.length,expression:"errors.length"}],staticClass:"invalid-feedback",staticStyle:{display:"block"}},[e._v("\n                  "+e._s(l[0])+"\n                ")])],1)]}}],null,!0)})],1)]),e._v(" "),o("div",{staticClass:"row"},[o("div",{staticClass:"col-6"},[o("ValidationProvider",{attrs:{rules:"required|numeric|integer",name:"Monto"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.validated,r=t.valid,l=t.errors;return[o("b-form-group",{staticClass:"mb-3",attrs:{label:"Monto:"}},[o("b-form-input",{attrs:{type:"number",state:!(!n||!r)||!l[0]&&null},model:{value:e.item.monto,callback:function(t){e.$set(e.item,"monto",t)},expression:"item.monto"}}),e._v(" "),o("b-form-invalid-feedback",[e._v(e._s(l[0]))])],1)]}}],null,!0)})],1)]),e._v(" "),o("div",{staticClass:"row"},[o("div",{staticClass:"col-6"},[o("ValidationProvider",{attrs:{rules:"required",name:"Departamento"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.validated,r=t.valid,l=t.errors;return[o("b-form-group",{staticClass:"mb-3",attrs:{label:"Departamento:"}},[o("multiselect-c",{class:n&&r?"is-valid":l[0]?"is-invalid":"",attrs:{options:e.listDepartamento,label:"nombre","track-by":"id",placeholder:"Elija un departamento"},on:{input:e.onChangeDepartamento},model:{value:e.departamentoSelected,callback:function(t){e.departamentoSelected=t},expression:"departamentoSelected"}},[o("span",{attrs:{slot:"noResult"},slot:"noResult"},[e._v("Oops! No se encontraron elementos.")]),e._v(" "),o("span",{attrs:{slot:"noOptions"},slot:"noOptions"},[e._v("Lista vacia.")])]),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:l.length,expression:"errors.length"}],staticClass:"invalid-feedback",staticStyle:{display:"block"}},[e._v("\n                  "+e._s(l[0])+"\n                ")])],1)]}}],null,!0)})],1),e._v(" "),o("div",{staticClass:"col-6"},[o("ValidationProvider",{attrs:{rules:"required",name:"Provincia"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.validated,r=t.valid,l=t.errors;return[o("b-form-group",{staticClass:"mb-3",attrs:{label:"Provincia:"}},[o("multiselect-c",{class:n&&r?"is-valid":l[0]?"is-invalid":"",attrs:{options:e.provinciasFiltrado,label:"nombre","track-by":"id",placeholder:"Elija un provincia"},on:{input:e.onChangeProvincia},model:{value:e.provinciaSelected,callback:function(t){e.provinciaSelected=t},expression:"provinciaSelected"}},[o("span",{attrs:{slot:"noResult"},slot:"noResult"},[e._v("Oops! No se encontraron elementos.")]),e._v(" "),o("span",{attrs:{slot:"noOptions"},slot:"noOptions"},[e._v("Lista vacia.")])]),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:l.length,expression:"errors.length"}],staticClass:"invalid-feedback",staticStyle:{display:"block"}},[e._v("\n                  "+e._s(l[0])+"\n                ")])],1)]}}],null,!0)})],1)]),e._v(" "),o("div",{staticClass:"row"},[o("div",{staticClass:"col-6"},[o("ValidationProvider",{attrs:{rules:"required",name:"Distrito"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.validated,r=t.valid,l=t.errors;return[o("b-form-group",{staticClass:"mb-3",attrs:{label:"Distrito:"}},[o("multiselect-c",{class:n&&r?"is-valid":l[0]?"is-invalid":"",attrs:{options:e.distritosFiltrado,label:"nombre","track-by":"id",placeholder:"Elija un distrito"},model:{value:e.distritoSelected,callback:function(t){e.distritoSelected=t},expression:"distritoSelected"}},[o("span",{attrs:{slot:"noResult"},slot:"noResult"},[e._v("Oops! No se encontraron elementos.")]),e._v(" "),o("span",{attrs:{slot:"noOptions"},slot:"noOptions"},[e._v("Lista vacia.")])]),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:l.length,expression:"errors.length"}],staticClass:"invalid-feedback",staticStyle:{display:"block"}},[e._v("\n                  "+e._s(l[0])+"\n                ")])],1)]}}],null,!0)})],1)])],1)]}}])})],1)],1)}),[],!1,null,null,null);t.default=component.exports}}]);