(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{689:function(e,t,o){"use strict";o.r(t);var n=o(25),r=(o(64),o(15),{props:{title:{type:String,default:"Enviar Revisión"}},data:function(){return{modalId:"modal-edit",openModalEvent:"open-edit-modal",refreshTableEvent:"refresh-table",apiUrlRevision:"/revision",msgSuccess:"Revisión enviado exitosamente!!!",isProcessing:!1,revision:{estado_revision_id:null,expedienteadhoc_archivo_id:null,observacion:""},item:{id:null,id_expediente:null,nombre_archivo:"",slug_archivo:"",valor_archivo:""},listEstadoRevision:[],estadoRevisionSelected:null,estado_observado:1}},watch:{estadoRevisionSelected:function(e){this.revision.estado_revision_id=e&&e.id?e.id:null},"revision.observacion":function(e){e=e||" "}},mounted:function(){this.loadSelectOptions()},created:function(){var e=this;this.$nuxt.$on(this.openModalEvent,(function(t){e.setItemValues(t),e.showModal()}))},beforeDestroy:function(){this.$nuxt.$off(this.openModalEvent)},methods:{refreshTable:function(){this.$nuxt.$emit(this.refreshTableEvent)},showModal:function(){this.$bvModal.show(this.modalId)},hideModal:function(){this.$bvModal.hide(this.modalId)},resetModal:function(){this.resetFormValues()},setItemValues:function(e){this.item.id=e.id_archivo,this.item.id_expediente=e.id_expediente,this.item.nombre_archivo=e.nombre_archivo,this.item.slug_archivo=e.slug_archivo,this.item.valor_archivo=e.valor_archivo,this.revision.expedienteadhoc_archivo_id=e.expedienteadhoc_archivo_id},resetFormValues:function(){this.item.id=null,this.item.id_expediente=null,this.item.nombre_archivo="",this.item.slug_archivo="",this.item.valor_archivo="",this.isProcessing=!1,this.revision.estado_revision_id=null,this.revision.expedienteadhoc_archivo_id=null,this.revision.observacion="",this.estadoRevisionSelected=null},handleOk:function(e){e.preventDefault(),this.onSubmit()},onSubmit:function(){var e=this;this.$refs.form.validate().then((function(t){t&&(e.revision.observacion||delete e.revision.observacion,e.isProcessing=!0,e.$axios.post(e.apiUrlRevision,e.revision).then((function(t){e.$notify({type:"success",text:e.msgSuccess})})).finally((function(){e.refreshTable(),e.hideModal()})))}))},loadSelectOptions:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.get("/listasParaEntregaExpediente").then((function(t){e.listEstadoRevision=t.data.estado_revision||[]}));case 2:case"end":return t.stop()}}),t)})))()}}}),l=o(12),component=Object(l.a)(r,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("b-modal",{attrs:{id:e.modalId,title:e.title,size:"md"},on:{ok:e.handleOk,hidden:e.resetModal},scopedSlots:e._u([{key:"modal-footer",fn:function(t){var n=t.ok,r=t.cancel;return[o("b-button",{attrs:{size:"md",variant:"link"},on:{click:function(e){return r()}}},[e._v(" Cancelar")]),e._v(" "),o("b-button",{attrs:{type:"submit",size:"md",variant:"primary",disabled:e.isProcessing},on:{click:function(e){return n()}}},[o("span",{directives:[{name:"show",rawName:"v-show",value:e.isProcessing,expression:"isProcessing"}],staticClass:"spinner-border spinner-border-sm"}),e._v(" "),o("i",{directives:[{name:"show",rawName:"v-show",value:!e.isProcessing,expression:"!isProcessing"}],staticClass:"fas fa-paper-plane"}),e._v(" Enviar Revisión\n      ")])]}}])},[e.revision.estado_revision_id==e.estado_observado?[o("b-alert",{attrs:{variant:"warning",show:""}},[o("p",{staticClass:"m-0"},[e._v("Se enviará un correo al usuario administrado, informándole sobre el estado de este archivo.")])])]:e._e(),e._v(" "),o("ValidationObserver",{ref:"form",on:{submit:function(e){e.preventDefault()}},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.handleSubmit;return[o("b-form",{on:{submit:function(t){return t.preventDefault(),n(e.onSubmit)}}},[o("b-form-group",{staticClass:"mb-3",attrs:{label:"Documento:"}},[o("p",{staticClass:"m-0"},[e._v(e._s(e.item.nombre_archivo))])]),e._v(" "),o("ValidationProvider",{attrs:{rules:"required",name:"Estado"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.validated,r=t.valid,l=t.errors;return[o("b-form-group",{staticClass:"mb-3",attrs:{label:"Estado:"}},[o("multiselect-c",{class:n&&r?"is-valid":l[0]?"is-invalid":"",attrs:{options:e.listEstadoRevision,label:"nombre","track-by":"id",placeholder:"Elija un estado"},model:{value:e.estadoRevisionSelected,callback:function(t){e.estadoRevisionSelected=t},expression:"estadoRevisionSelected"}},[o("span",{attrs:{slot:"noResult"},slot:"noResult"},[e._v("Oops! No se encontraron elementos.")]),e._v(" "),o("span",{attrs:{slot:"noOptions"},slot:"noOptions"},[e._v("Lista vacia.")])]),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:l.length,expression:"errors.length"}],staticClass:"invalid-feedback",staticStyle:{display:"block"}},[e._v("\n              "+e._s(l[0])+"\n            ")])],1)]}}],null,!0)}),e._v(" "),e.revision.estado_revision_id==e.estado_observado?[o("ValidationProvider",{attrs:{rules:"required",name:"Observación"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.validated,r=t.valid,l=t.errors;return[o("b-form-group",{staticClass:"mb-3",attrs:{label:"Observación:"}},[o("b-form-textarea",{class:n&&r?"is-valid":l[0]?"is-invalid":"",attrs:{id:"textarea",placeholder:"Escriba alguna observación...",rows:"2","max-rows":"3"},model:{value:e.revision.observacion,callback:function(t){e.$set(e.revision,"observacion",t)},expression:"revision.observacion"}}),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:l.length,expression:"errors.length"}],staticClass:"invalid-feedback",staticStyle:{display:"block"}},[e._v("\n                "+e._s(l[0])+"\n              ")])],1)]}}],null,!0)})]:e._e()],2)]}}])})],2)],1)}),[],!1,null,null,null);t.default=component.exports}}]);