(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{686:function(e,t,o){"use strict";o.r(t);o(15);var n=o(586),r=(o(587),o(588),{components:{DatePicker:n.default},props:{title:{type:String,default:"Subir Archivo"}},data:function(){return{modalId:"modal-edit",openModalEvent:"open-edit-modal",refreshTableEvent:"refresh-table",apiUrlPartial:"/expedienteadhoc/",msgSuccess:"Archivo subido exitosamente!!!",isProcessing:!1,item:{id:null,id_expediente:null,nombre_archivo:"",slug_archivo:"",valor_archivo:"",observacion:""},fileToUpload:null,isNewFile:!1}},computed:{apiUrl:function(){return this.apiUrlPartial+this.item.id_expediente}},created:function(){var e=this;this.$nuxt.$on(this.openModalEvent,(function(t){e.setItemValues(t),e.showModal()}))},beforeDestroy:function(){this.$nuxt.$off(this.openModalEvent)},methods:{refreshTable:function(){this.$nuxt.$emit(this.refreshTableEvent)},showModal:function(){this.$bvModal.show(this.modalId)},hideModal:function(){this.$bvModal.hide(this.modalId)},resetModal:function(){this.resetFormValues()},setItemValues:function(e){this.item.id=e.id_archivo,this.item.id_expediente=e.id_expediente,this.item.nombre_archivo=e.nombre_archivo,this.item.slug_archivo=e.slug_archivo,this.item.valor_archivo=e.valor_archivo,this.item.observacion=e.observacion,this.isNewFile=!e.valor_archivo},resetFormValues:function(){this.item.id=null,this.item.id_expediente=null,this.item.nombre_archivo="",this.item.slug_archivo="",this.item.valor_archivo="",this.item.observacion="",this.fileToUpload=null,this.isNewFile=!1,this.isProcessing=!1},handleOk:function(e){e.preventDefault(),this.onSubmit()},onSubmit:function(){var e=this;this.$refs.form.validate().then((function(t){if(t){e.isProcessing=!0;var data=new FormData;data.append("_method","put"),data.append("archivo[0][id]",e.item.id),data.append("archivo[0][valor]",e.fileToUpload),e.$axios.post(e.apiUrl,data).then((function(t){e.$notify({type:"success",text:e.msgSuccess})})).finally((function(){e.refreshTable(),e.hideModal()}))}}))},handleFileChange:function(e){var t=e.target.files||e.dataTransfer.files;t.length&&(this.fileToUpload=t[0])},requestChangeFile:function(){this.isNewFile=!this.isNewFile}}}),l=o(12),component=Object(l.a)(r,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("b-modal",{attrs:{id:e.modalId,title:e.title,size:"md"},on:{ok:e.handleOk,hidden:e.resetModal},scopedSlots:e._u([{key:"modal-footer",fn:function(t){var n=t.ok,r=t.cancel;return[o("b-button",{attrs:{size:"md",variant:"link"},on:{click:function(e){return r()}}},[e._v(" Cancelar")]),e._v(" "),o("b-button",{attrs:{type:"submit",size:"md",variant:"primary",disabled:!e.isNewFile||e.isProcessing},on:{click:function(e){return n()}}},[o("span",{directives:[{name:"show",rawName:"v-show",value:e.isProcessing,expression:"isProcessing"}],staticClass:"spinner-border spinner-border-sm"}),e._v(" "),o("i",{directives:[{name:"show",rawName:"v-show",value:!e.isProcessing,expression:"!isProcessing"}],staticClass:"fas fa-paper-plane"}),e._v(" Subir Archivo\n      ")])]}}])},[e.isNewFile?o("div",{staticClass:"alert alert-warning",attrs:{role:"alert"}},[o("ul",{staticStyle:{margin:"0"}},[o("li",[e._v("\n          El documento deberá ser subido en "),o("b",[e._v("formato PDF")]),e._v(" ( "),o("b",[o("i",{staticClass:"fas fa-file-pdf"})]),e._v(" )\n        ")]),e._v(" "),o("li",[e._v("Limite de tamaño por archivo es de "),o("b",[e._v("10 MB")]),e._v(" (10 megabytes)")])])]):e._e(),e._v(" "),o("ValidationObserver",{ref:"form",on:{submit:function(e){e.preventDefault()}},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.handleSubmit;return[o("b-form",{on:{submit:function(t){return t.preventDefault(),n(e.onSubmit)}}},[o("div",{staticClass:"row"},[o("div",{staticClass:"col-12"},[e.isNewFile?[o("ValidationProvider",{attrs:{mode:"eager",rules:"required|ext:pdf|size:11264",name:"Archivo"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.validate,r=t.errors;return[o("b-form-group",{staticClass:"mb-3",attrs:{label:e.item.nombre_archivo+":"}},[o("input",{staticClass:"form-control",attrs:{type:"file"},on:{change:function(t){e.handleFileChange(t)||n(t)}}}),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:r.length,expression:"errors.length"}],staticClass:"invalid-feedback",staticStyle:{display:"block"}},[e._v("\n                    "+e._s(r[0])+"\n                  ")])])]}}],null,!0)})]:[o("b-form-group",{staticClass:"mb-3",attrs:{label:e.item.nombre_archivo+":"}},[o("a",{staticClass:"text-decoration",attrs:{href:"javascript:void(0);"},on:{click:function(t){return t.stopPropagation(),e.$downloadFile(e.item.valor_archivo)}}},[o("i",{staticClass:"uil uil-file-info-alt font-size-18"}),e._v(" Ver documento\n                ")]),e._v(" "),o("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"btn btn-outline-danger btn-sm",staticStyle:{"margin-left":"20px"},attrs:{type:"button",title:"Subir nuevo archivo"},on:{click:e.requestChangeFile}},[e._v("\n                  Cambiar\n                ")])])],e._v(" "),e.item.observacion?o("div",{staticClass:"mb-3"},[o("label",{staticClass:"form-label"},[e._v("Observación:")]),e._v(" "),o("p",{staticClass:"text-muted m-0"},[e._v("\n                "+e._s(e.item.observacion)+"\n              ")])]):e._e()],2)])])]}}])})],1)],1)}),[],!1,null,null,null);t.default=component.exports}}]);